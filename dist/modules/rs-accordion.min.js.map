{"version":3,"file":"rs-accordion.min.js","sources":["../../src/modules/accordion.js"],"sourcesContent":["// src/modules/accordion.js\r\n(function () {\r\n  if (!window.RS || !window.RS.register) {\r\n    console.warn(\"[RS] core is missing. Include rs-core.min.js first.\");\r\n    return;\r\n  }\r\n\r\n  const SEL = {\r\n    item: \"[data-rs-accordion-item]\",\r\n    head: \"[data-rs-accordion-head]\",\r\n    panel: \"[data-rs-accordion-panel]\",\r\n  };\r\n\r\n  function getOffset(item) {\r\n    const raw =\r\n      item.getAttribute(\"data-rs-accordion-offset\") ||\r\n      item.closest(\"[data-rs-accordion-offset]\")?.getAttribute(\"data-rs-accordion-offset\") ||\r\n      \"0\";\r\n\r\n    const n = parseInt(raw, 10);\r\n    return Number.isFinite(n) ? n : 0;\r\n  }\r\n\r\n  function setPanelHeight(item) {\r\n    const panel = item.querySelector(SEL.panel);\r\n    if (!panel) return;\r\n\r\n    const offset = getOffset(item);\r\n    panel.style.maxHeight = (panel.scrollHeight + offset) + \"px\";\r\n  }\r\n\r\n  function closeItem(item) {\r\n    const head = item.querySelector(SEL.head);\r\n    const panel = item.querySelector(SEL.panel);\r\n    if (!panel) return;\r\n\r\n    item.classList.remove(\"is-open\");\r\n    head?.classList.remove(\"is-open\");\r\n    panel.classList.remove(\"is-open\");\r\n\r\n    // Animate to 0\r\n    panel.style.maxHeight = \"0px\";\r\n\r\n    window.RS.emit?.(\"rs:accordion:close\", { item });\r\n  }\r\n\r\n  function openItem(item) {\r\n    const head = item.querySelector(SEL.head);\r\n    const panel = item.querySelector(SEL.panel);\r\n    if (!panel) return;\r\n\r\n    item.classList.add(\"is-open\");\r\n    head?.classList.add(\"is-open\");\r\n    panel.classList.add(\"is-open\");\r\n\r\n    setPanelHeight(item);\r\n\r\n    window.RS.emit?.(\"rs:accordion:open\", { item });\r\n  }\r\n\r\n  function toggleItem(item) {\r\n    if (item.classList.contains(\"is-open\")) {\r\n      closeItem(item);\r\n    } else {\r\n      // group logic: якщо є group — закриваємо інші open в цій групі\r\n      const group = item.getAttribute(\"data-rs-accordion-group\");\r\n      if (group) {\r\n        document\r\n          .querySelectorAll(`${SEL.item}[data-rs-accordion-group=\"${CSS.escape(group)}\"].is-open`)\r\n          .forEach((el) => {\r\n            if (el !== item) closeItem(el);\r\n          });\r\n      }\r\n\r\n      openItem(item);\r\n    }\r\n  }\r\n\r\n  function initDefaults() {\r\n    document.querySelectorAll(SEL.item).forEach((item) => {\r\n      const openAttr = item.getAttribute(\"data-rs-accordion-open\");\r\n      const shouldOpen = item.classList.contains(\"is-open\") || openAttr === \"true\";\r\n\r\n      const panel = item.querySelector(SEL.panel);\r\n      if (!panel) return;\r\n\r\n      if (shouldOpen) {\r\n        // ensure state + height\r\n        item.classList.add(\"is-open\");\r\n        item.querySelector(SEL.head)?.classList.add(\"is-open\");\r\n        panel.classList.add(\"is-open\");\r\n        setPanelHeight(item);\r\n      } else {\r\n        panel.style.maxHeight = \"0px\";\r\n      }\r\n    });\r\n  }\r\n\r\n  function bindEvents() {\r\n    // click\r\n    document.addEventListener(\"click\", (e) => {\r\n      const head = e.target.closest(SEL.head);\r\n      if (!head) return;\r\n\r\n      const item = head.closest(SEL.item);\r\n      if (!item) return;\r\n\r\n      toggleItem(item);\r\n    });\r\n\r\n    // optional keyboard (якщо head = div). Не ламає кнопки.\r\n    document.addEventListener(\"keydown\", (e) => {\r\n      if (e.key !== \"Enter\" && e.key !== \" \") return;\r\n\r\n      const head = e.target.closest?.(SEL.head);\r\n      if (!head) return;\r\n\r\n      // prevent page scroll on Space\r\n      e.preventDefault();\r\n\r\n      const item = head.closest(SEL.item);\r\n      if (!item) return;\r\n\r\n      toggleItem(item);\r\n    });\r\n\r\n    // resize: перерахувати висоту для відкритих\r\n    window.addEventListener(\"resize\", () => {\r\n      document.querySelectorAll(`${SEL.item}.is-open`).forEach(setPanelHeight);\r\n    });\r\n  }\r\n\r\n  window.RS.register(\"accordion\", function initAccordion() {\r\n    initDefaults();\r\n    bindEvents();\r\n    window.RS.debug?.(\"accordion ready\");\r\n  });\r\n})();\r\n"],"names":["window","RS","register","console","warn","SEL","setPanelHeight","item","panel","querySelector","offset","raw","getAttribute","closest","n","parseInt","Number","isFinite","getOffset","style","maxHeight","scrollHeight","closeItem","head","classList","remove","emit","toggleItem","contains","group","document","querySelectorAll","CSS","escape","forEach","el","add","openItem","openAttr","shouldOpen","addEventListener","e","target","key","preventDefault","debug"],"mappings":"0BACA,WACE,IAAKA,OAAOC,KAAOD,OAAOC,GAAGC,SAE3B,YADAC,QAAQC,KAAK,uDAIf,MAAMC,EACE,2BADFA,EAEE,2BAFFA,EAGG,4BAaT,SAASC,EAAeC,GACtB,MAAMC,EAAQD,EAAKE,cAAcJ,GACjC,IAAKG,EAAO,OAEZ,MAAME,EAdR,SAAmBH,GACjB,MAAMI,EACJJ,EAAKK,aAAa,6BAClBL,EAAKM,QAAQ,+BAA+BD,aAAa,6BACzD,IAEIE,EAAIC,SAASJ,EAAK,IACxB,OAAOK,OAAOC,SAASH,GAAKA,EAAI,CAClC,CAMiBI,CAAUX,GACzBC,EAAMW,MAAMC,UAAaZ,EAAMa,aAAeX,EAAU,IAC1D,CAEA,SAASY,EAAUf,GACjB,MAAMgB,EAAOhB,EAAKE,cAAcJ,GAC1BG,EAAQD,EAAKE,cAAcJ,GAC5BG,IAELD,EAAKiB,UAAUC,OAAO,WACtBF,GAAMC,UAAUC,OAAO,WACvBjB,EAAMgB,UAAUC,OAAO,WAGvBjB,EAAMW,MAAMC,UAAY,MAExBpB,OAAOC,GAAGyB,OAAO,qBAAsB,CAAEnB,SAC3C,CAgBA,SAASoB,EAAWpB,GAClB,GAAIA,EAAKiB,UAAUI,SAAS,WAC1BN,EAAUf,OACL,CAEL,MAAMsB,EAAQtB,EAAKK,aAAa,2BAC5BiB,GACFC,SACGC,iBAAiB,GAAG1B,8BAAqC2B,IAAIC,OAAOJ,gBACpEK,QAASC,IACJA,IAAO5B,GAAMe,EAAUa,KAxBrC,SAAkB5B,GAChB,MAAMgB,EAAOhB,EAAKE,cAAcJ,GAC1BG,EAAQD,EAAKE,cAAcJ,GAC5BG,IAELD,EAAKiB,UAAUY,IAAI,WACnBb,GAAMC,UAAUY,IAAI,WACpB5B,EAAMgB,UAAUY,IAAI,WAEpB9B,EAAeC,GAEfP,OAAOC,GAAGyB,OAAO,oBAAqB,CAAEnB,SAC1C,CAgBI8B,CAAS9B,EACX,CACF,CAwDAP,OAAOC,GAAGC,SAAS,YAAa,WArD9B4B,SAASC,iBAAiB1B,GAAU6B,QAAS3B,IAC3C,MAAM+B,EAAW/B,EAAKK,aAAa,0BAC7B2B,EAAahC,EAAKiB,UAAUI,SAAS,YAA2B,SAAbU,EAEnD9B,EAAQD,EAAKE,cAAcJ,GAC5BG,IAED+B,GAEFhC,EAAKiB,UAAUY,IAAI,WACnB7B,EAAKE,cAAcJ,IAAWmB,UAAUY,IAAI,WAC5C5B,EAAMgB,UAAUY,IAAI,WACpB9B,EAAeC,IAEfC,EAAMW,MAAMC,UAAY,SAO5BU,SAASU,iBAAiB,QAAUC,IAClC,MAAMlB,EAAOkB,EAAEC,OAAO7B,QAAQR,GAC9B,IAAKkB,EAAM,OAEX,MAAMhB,EAAOgB,EAAKV,QAAQR,GACrBE,GAELoB,EAAWpB,KAIbuB,SAASU,iBAAiB,UAAYC,IACpC,GAAc,UAAVA,EAAEE,KAA6B,MAAVF,EAAEE,IAAa,OAExC,MAAMpB,EAAOkB,EAAEC,OAAO7B,UAAUR,GAChC,IAAKkB,EAAM,OAGXkB,EAAEG,iBAEF,MAAMrC,EAAOgB,EAAKV,QAAQR,GACrBE,GAELoB,EAAWpB,KAIbP,OAAOwC,iBAAiB,SAAU,KAChCV,SAASC,iBAAiB,GAAG1B,aAAoB6B,QAAQ5B,KAO3DN,OAAOC,GAAG4C,QAAQ,kBACpB,EACD,CAxID"}