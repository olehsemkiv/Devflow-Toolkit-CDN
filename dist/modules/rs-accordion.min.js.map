{"version":3,"file":"rs-accordion.min.js","sources":["../../src/modules/accordion.js"],"sourcesContent":["// src/modules/accordion.js\r\n(function () {\r\n  if (!window.RS || !window.RS.register) {\r\n    console.warn(\"[RS] core is missing. Include rs-core.min.js first.\");\r\n    return;\r\n  }\r\n\r\n  const SEL = {\r\n    item: \"[data-rs-accordion-item]\",\r\n    head: \"[data-rs-accordion-head]\",\r\n    panel: \"[data-rs-accordion-panel]\",\r\n  };\r\n\r\n  function getOffset(item) {\r\n    const raw =\r\n      item.getAttribute(\"data-rs-accordion-offset\") ||\r\n      item.closest(\"[data-rs-accordion-offset]\")?.getAttribute(\"data-rs-accordion-offset\") ||\r\n      \"0\";\r\n\r\n    const n = parseInt(raw, 10);\r\n    return Number.isFinite(n) ? n : 0;\r\n  }\r\n\r\n  function getTriggerMode(item) {\r\n    // \"item\" (default) або \"head\"\r\n    return (\r\n      item.getAttribute(\"data-rs-accordion-trigger\") ||\r\n      item.closest(\"[data-rs-accordion-trigger]\")?.getAttribute(\"data-rs-accordion-trigger\") ||\r\n      \"item\"\r\n    );\r\n  }\r\n\r\n  function setPanelHeight(item) {\r\n    const panel = item.querySelector(SEL.panel);\r\n    if (!panel) return;\r\n\r\n    const offset = getOffset(item);\r\n    panel.style.maxHeight = panel.scrollHeight + offset + \"px\";\r\n  }\r\n\r\n  function closeItem(item) {\r\n    const head = item.querySelector(SEL.head);\r\n    const panel = item.querySelector(SEL.panel);\r\n    if (!panel) return;\r\n\r\n    item.classList.remove(\"is-open\");\r\n    head?.classList.remove(\"is-open\");\r\n    panel.classList.remove(\"is-open\");\r\n\r\n    panel.style.maxHeight = \"0px\";\r\n\r\n    window.RS.emit?.(\"rs:accordion:close\", { item });\r\n  }\r\n\r\n  function openItem(item) {\r\n    const head = item.querySelector(SEL.head);\r\n    const panel = item.querySelector(SEL.panel);\r\n    if (!panel) return;\r\n\r\n    item.classList.add(\"is-open\");\r\n    head?.classList.add(\"is-open\");\r\n    panel.classList.add(\"is-open\");\r\n\r\n    setPanelHeight(item);\r\n\r\n    window.RS.emit?.(\"rs:accordion:open\", { item });\r\n  }\r\n\r\n  function toggleItem(item) {\r\n    if (item.classList.contains(\"is-open\")) {\r\n      closeItem(item);\r\n      return;\r\n    }\r\n\r\n    const group = item.getAttribute(\"data-rs-accordion-group\");\r\n    if (group) {\r\n      // закриваємо інші відкриті в групі\r\n      document\r\n        .querySelectorAll(\r\n          `${SEL.item}[data-rs-accordion-group=\"${CSS.escape(group)}\"].is-open`\r\n        )\r\n        .forEach((el) => {\r\n          if (el !== item) closeItem(el);\r\n        });\r\n    }\r\n\r\n    openItem(item);\r\n  }\r\n\r\n  function initDefaults() {\r\n    document.querySelectorAll(SEL.item).forEach((item) => {\r\n      const openAttr = item.getAttribute(\"data-rs-accordion-open\");\r\n      const shouldOpen = item.classList.contains(\"is-open\") || openAttr === \"true\";\r\n\r\n      const head = item.querySelector(SEL.head);\r\n      const panel = item.querySelector(SEL.panel);\r\n      if (!panel) return;\r\n\r\n      if (shouldOpen) {\r\n        item.classList.add(\"is-open\");\r\n        head?.classList.add(\"is-open\");\r\n        panel.classList.add(\"is-open\");\r\n        setPanelHeight(item);\r\n      } else {\r\n        panel.style.maxHeight = \"0px\";\r\n      }\r\n    });\r\n  }\r\n\r\n  function bindEvents() {\r\n    const INTERACTIVE = \"a,button,input,textarea,select,label\";\r\n\r\n    // click\r\n    document.addEventListener(\"click\", (e) => {\r\n      const item = e.target.closest(SEL.item);\r\n      if (!item) return;\r\n\r\n      const mode = getTriggerMode(item);\r\n\r\n      // Mode: head only\r\n      if (mode === \"head\") {\r\n        const head = e.target.closest(SEL.head);\r\n        if (!head || !item.contains(head)) return;\r\n\r\n        toggleItem(item);\r\n        return;\r\n      }\r\n\r\n      // Mode: item (default)\r\n      // 1) не тогглимо кліки в panel\r\n      if (e.target.closest(SEL.panel)) return;\r\n\r\n      // 2) можна вручну вимкнути toggle на окремих елементах\r\n      if (e.target.closest(\"[data-rs-accordion-ignore]\")) return;\r\n\r\n      // 3) не тогглимо інтерактивні елементи, якщо вони не в head\r\n      const interactiveEl = e.target.closest(INTERACTIVE);\r\n      if (interactiveEl && !interactiveEl.closest(SEL.head)) return;\r\n\r\n      toggleItem(item);\r\n    });\r\n\r\n    // keyboard: працює через head\r\n    document.addEventListener(\"keydown\", (e) => {\r\n      if (e.key !== \"Enter\" && e.key !== \" \") return;\r\n\r\n      const head = e.target.closest?.(SEL.head);\r\n      if (!head) return;\r\n\r\n      // prevent page scroll on Space\r\n      e.preventDefault();\r\n\r\n      const item = head.closest(SEL.item);\r\n      if (!item) return;\r\n\r\n      toggleItem(item);\r\n    });\r\n\r\n    // resize: перерахувати висоту для відкритих\r\n    window.addEventListener(\"resize\", () => {\r\n      document.querySelectorAll(`${SEL.item}.is-open`).forEach(setPanelHeight);\r\n    });\r\n  }\r\n\r\n  window.RS.register(\"accordion\", function initAccordion() {\r\n    initDefaults();\r\n    bindEvents();\r\n    window.RS.debug?.(\"accordion ready\");\r\n  });\r\n})();\r\n"],"names":["window","RS","register","console","warn","SEL","setPanelHeight","item","panel","querySelector","offset","raw","getAttribute","closest","n","parseInt","Number","isFinite","getOffset","style","maxHeight","scrollHeight","closeItem","head","classList","remove","emit","toggleItem","contains","group","document","querySelectorAll","CSS","escape","forEach","el","add","openItem","openAttr","shouldOpen","addEventListener","e","target","mode","getTriggerMode","interactiveEl","key","preventDefault","debug"],"mappings":"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"}